var q=(t,n,c)=>new Promise((p,g)=>{var D=i=>{try{v(c.next(i))}catch(e){g(e)}},d=i=>{try{v(c.throw(i))}catch(e){g(e)}},v=i=>i.done?p(i.value):Promise.resolve(i.value).then(D,d);v((c=c.apply(t,n)).next())});import{d as A,l as F,H as C,Z as S,j as E,r as l,o as r,c as I,b as a,w as o,n as h,e as R,t as B,F as U,q as J,D as k,E as L,u as s,a5 as le,a6 as X,h as O,J as ie,M as re,I as de,N as _e,a7 as ue,a8 as pe,a9 as T,R as V,Q as Y,U as Z}from"./index-3efa3bcd.js";import{i as ee}from"./icon-f6cbc454.js";import{M as te}from"./index-378130bb.js";import{m as me,d as ge,a as ve,b as fe}from"./project.api-31a95c84.js";import{g as G,D as K}from"./plugin-52ae8d1b.js";const he={key:0,class:"go-items-list-card"},we={class:"list-content"},be={class:"list-content-top"},ye={class:"go-flex-items-center list-footer",justify:"space-between"},ke={class:"go-flex-items-center list-footer-ri"},De=A({__name:"index",props:{cardData:Object},emits:["preview","delete","copy","resize","edit","release"],setup(t,{emit:n}){var y;const c=t,{EllipsisHorizontalCircleSharpIcon:p,CopyIcon:g,TrashIcon:D,PencilIcon:d,DownloadIcon:v,BrowsersOutlineIcon:i,HammerIcon:e,SendIcon:_}=ee.ionicons5,w=F([{label:C("global.r_edit"),key:"edit",icon:S(e)},{lable:C("global.r_more"),key:"select",icon:S(p)}]),m=E([{label:C("global.r_preview"),key:"preview",icon:S(i)},{label:(y=c.cardData)!=null&&y.release?C("global.r_unpublish"):C("global.r_publish"),key:"release",icon:S(_)},{label:C("global.r_copy"),key:"copy",icon:S(g)},{label:C("global.r_delete"),key:"delete",icon:S(D)}]),b=f=>{switch(f){case"preview":x();break;case"delete":H();break;case"copy":z();break;case"release":P();break;case"edit":$();break}},x=()=>{n("preview",c.cardData)},H=()=>{n("delete",c.cardData)},z=()=>{n("copy",c.cardData)},$=()=>{n("edit",c.cardData)},P=()=>{n("release",c.cardData)},u=()=>{n("resize",c.cardData)};return(f,M)=>{const N=l("n-image"),Q=l("n-text"),ae=l("n-badge"),W=l("n-button"),ne=l("n-dropdown"),oe=l("n-tooltip"),se=l("n-space"),ce=l("n-card");return t.cardData?(r(),I("div",he,[a(ce,{hoverable:"",size:"small"},{action:o(()=>[h("div",ye,[a(Q,{class:"go-ellipsis-1"},{default:o(()=>[R(B(t.cardData.title||t.cardData.id||"未命名"),1)]),_:1}),h("div",ke,[a(se,null,{default:o(()=>[a(Q,null,{default:o(()=>[a(ae,{class:"go-animation-twinkle",dot:"",color:t.cardData.release?"#34c749":"#fcbc40"},null,8,["color"]),R(" "+B(t.cardData.release?f.$t("project.release"):f.$t("project.unreleased")),1)]),_:1}),(r(!0),I(U,null,J(w,j=>(r(),I(U,{key:j.key},[j.key==="select"?(r(),k(ne,{key:0,trigger:"hover",placement:"bottom",options:m.value,"show-arrow":!0,onSelect:b},{default:o(()=>[a(W,{size:"small"},{icon:o(()=>[(r(),k(L(j.icon)))]),_:2},1024)]),_:2},1032,["options"])):(r(),k(oe,{key:1,placement:"bottom",trigger:"hover"},{trigger:o(()=>[a(W,{size:"small",onClick:Ue=>b(j.key)},{icon:o(()=>[(r(),k(L(j.icon)))]),_:2},1032,["onClick"])]),default:o(()=>[(r(),k(L(j.label)))]),_:2},1024))],64))),128))]),_:1})])])]),default:o(()=>[h("div",we,[h("div",be,[a(s(te),{class:"top-btn",hidden:["remove"],onClose:H,onResize:u})]),h("div",{class:"list-content-img",onClick:u},[a(N,{"object-fit":"contain",height:"180","preview-disabled":"",src:`${t.cardData.image}?time=${new Date().getTime()}`,alt:t.cardData.title,"fallback-src":s(le)()},null,8,["src","alt","fallback-src"])])])]),_:1})])):X("",!0)}}});const Ce=O(De,[["__scopeId","data-v-6e4e385f"]]),xe={class:"list-content"},He={class:"list-content-img"},$e=["src","alt"],Se=A({__name:"index",props:{modalShow:{required:!0,type:Boolean},cardData:{required:!0,type:Object}},emits:["close","edit"],setup(t,{emit:n}){const c=t,{HammerIcon:p}=ee.ionicons5,g=E(!1);ie(()=>c.modalShow,e=>{g.value=e},{immediate:!0});const D=F([{label:C("global.r_edit"),key:"edit",icon:S(p)}]),d=e=>{switch(e){case"edit":v();break}},v=()=>{n("edit",c.cardData)},i=()=>{n("close")};return(e,_)=>{const w=l("n-text"),m=l("n-space"),b=l("n-time"),x=l("n-badge"),H=l("n-button"),z=l("n-tooltip"),$=l("n-card"),P=l("n-modal");return r(),k(P,{class:"go-modal-box",show:g.value,"onUpdate:show":_[0]||(_[0]=u=>g.value=u),onAfterLeave:i},{default:o(()=>[a($,{hoverable:"",size:"small"},{action:o(()=>[a(m,{class:"list-footer",justify:"space-between"},{default:o(()=>[a(w,{depth:"3"},{default:o(()=>[R(B(e.$t("project.last_edit"))+": ",1),a(b,{time:new Date,format:"yyyy-MM-dd hh:mm"},null,8,["time"])]),_:1}),a(m,null,{default:o(()=>[a(w,null,{default:o(()=>{var u,y;return[a(x,{class:"go-animation-twinkle",dot:"",color:(u=t.cardData)!=null&&u.release?"#34c749":"#fcbc40"},null,8,["color"]),R(" "+B((y=t.cardData)!=null&&y.release?e.$t("project.release"):e.$t("project.unreleased")),1)]}),_:1}),(r(!0),I(U,null,J(D,u=>(r(),k(z,{key:u.key,placement:"bottom",trigger:"hover"},{trigger:o(()=>[a(H,{size:"small",onClick:y=>d(u.key)},{icon:o(()=>[(r(),k(L(u.icon)))]),_:2},1032,["onClick"])]),default:o(()=>[(r(),k(L(u.label)))]),_:2},1024))),128))]),_:1})]),_:1})]),default:o(()=>{var u,y;return[h("div",xe,[a(m,{class:"list-content-top go-px-0",justify:"center"},{default:o(()=>[a(m,null,{default:o(()=>[a(w,null,{default:o(()=>{var f,M;return[R(B(((f=t.cardData)==null?void 0:f.title)||((M=t.cardData)==null?void 0:M.id)||"未命名"),1)]}),_:1})]),_:1})]),_:1}),a(m,{class:"list-content-top"},{default:o(()=>[a(s(te),{narrow:!0,hidden:["close"],onRemove:i})]),_:1}),h("div",He,[h("img",{src:(u=t.cardData)==null?void 0:u.image,alt:(y=t.cardData)==null?void 0:y.title},null,8,$e)])])]}),_:1})]),_:1},8,["show"])}}});const Ie=O(Se,[["__scopeId","data-v-2c04eca0"]]),ze=()=>{const t=E(!1),n=E(null);return{modalData:n,modalShow:t,closeModal:()=>{t.value=!1,n.value=null},resizeHandle:d=>{d&&(t.value=!0,n.value=d)},editHandle:d=>{if(!d)return;const v=re(de.CHART_HOME_NAME,"href");_e(v,[d.id],void 0,!0)},previewHandle:d=>{ue(pe(d.id))}}},je=()=>{const t=E(!0),n=F({page:1,limit:12,count:10}),c=E([]),p=()=>q(void 0,null,function*(){t.value=!0;const e=yield me({page:n.page,limit:n.limit,random:Math.random()});if(e&&e.data){const{count:_}=e;n.count=_,c.value=e.data.map(w=>{const{id:m,projectName:b,state:x,createTime:H,indexImage:z,createUserId:$}=w;return{id:m,title:b,createId:$,time:H,image:z,release:x!==-1}}),setTimeout(()=>{t.value=!1},500);return}T()}),g=e=>{n.page=e,p()},D=e=>{n.limit=e,p()},d=e=>{G({type:K.DELETE,promise:!0,onPositiveCallback:()=>new Promise(_=>{_(ge({ids:e.id}))}),promiseResCallback:_=>{if(_.code===V.SUCCESS){window.$message.success(window.$t("global.r_delete_success")),p();return}T()}})},v=e=>{G({type:K.COPY,promise:!0,onPositiveCallback:()=>new Promise(_=>{_(ve({ids:e.id}))}),promiseResCallback:_=>{if(_.code===V.SUCCESS){window.$message.success(window.$t("global.r_copy_success")),p();return}T()}})},i=(e,_)=>q(void 0,null,function*(){const{id:w,release:m}=e,b=yield fe({id:w,state:m?-1:1});if(b&&b.code===V.SUCCESS){if(c.value=[],p(),m){window.$message.success(window.$t("global.r_unpublish_success"));return}window.$message.success(window.$t("global.r_publish_success"));return}T()});return p(),{loading:t,paginat:n,list:c,fetchList:p,releaseHandle:i,changeSize:D,changePage:g,deleteHandle:d,copyHandle:v}},Ee={class:"go-items-list"},Pe={class:"list-pagination"},Me=A({__name:"index",setup(t){const{modalData:n,modalShow:c,closeModal:p,previewHandle:g,resizeHandle:D,editHandle:d}=ze(),{loading:v,paginat:i,list:e,changeSize:_,changePage:w,releaseHandle:m,deleteHandle:b,copyHandle:x}=je();return(H,z)=>{const $=l("go-loading"),P=l("n-grid-item"),u=l("n-grid"),y=l("n-pagination");return r(),I(U,null,[h("div",Ee,[Y(h("div",null,[a($)],512),[[Z,s(v)]]),Y(h("div",null,[a(u,{"x-gap":20,"y-gap":20,cols:"2 s:2 m:3 l:4 xl:4 xxl:4",responsive:"screen"},{default:o(()=>[(r(!0),I(U,null,J(s(e),(f,M)=>(r(),k(P,{key:f.id},{default:o(()=>[a(s(Ce),{cardData:f,onPreview:s(g),onResize:s(D),onDelete:N=>s(b)(f),onCopy:N=>s(x)(f),onRelease:N=>s(m)(f,M),onEdit:s(d)},null,8,["cardData","onPreview","onResize","onDelete","onCopy","onRelease","onEdit"])]),_:2},1024))),128))]),_:1})],512),[[Z,!s(v)]]),h("div",Pe,[a(y,{page:s(i).page,"page-size":s(i).limit,"item-count":s(i).count,"page-sizes":[12,24,36,48],"onUpdate:page":s(w),"onUpdate:pageSize":s(_),"show-size-picker":""},null,8,["page","page-size","item-count","onUpdate:page","onUpdate:pageSize"])])]),s(n)?(r(),k(s(Ie),{key:0,modalShow:s(c),cardData:s(n),onClose:s(p),onEdit:s(d)},null,8,["modalShow","cardData","onClose","onEdit"])):X("",!0)],64)}}});const Re=O(Me,[["__scopeId","data-v-24e112db"]]),Be={class:"go-project-items"},Le=A({__name:"index",setup(t){return(n,c)=>(r(),I("div",Be,[a(s(Re))]))}});const Fe=O(Le,[["__scopeId","data-v-8c80d048"]]);export{Fe as default};
