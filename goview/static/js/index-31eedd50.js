var A=(t,s,l)=>new Promise((p,m)=>{var y=e=>{try{g(l.next(e))}catch(c){m(c)}},r=e=>{try{g(l.throw(e))}catch(c){m(c)}},g=e=>e.done?p(e.value):Promise.resolve(e.value).then(y,r);g((l=l.apply(t,s)).next())});import{d as L,l as q,H as U,Z as O,r as i,o as _,c as I,b as a,w as o,n as h,e as z,t as E,F as B,q as V,D,E as R,u as n,a5 as X,a6 as W,h as N,j,J as ee,M as te,I as ae,N as ne,a7 as oe,a8 as se,a9 as T,R as F,aa as ce,P as le,Q as J,U as Q}from"./index-3efa3bcd.js";import{i as Y}from"./icon-f6cbc454.js";import{M as Z}from"./index-378130bb.js";import{t as ie,a as re,b as de}from"./project.api-31a95c84.js";import{g as _e,D as ue}from"./plugin-52ae8d1b.js";const pe={key:0,class:"go-items-list-card"},me={class:"list-content"},ge={class:"list-content-top"},ve={class:"go-flex-items-center list-footer",justify:"space-between"},fe={class:"go-flex-items-center list-footer-ri"},he=L({__name:"index",props:{cardData:Object},emits:["preview","copy","resize"],setup(t,{emit:s}){const l=t,{EllipsisHorizontalCircleSharpIcon:p,CopyIcon:m,TrashIcon:y,PencilIcon:r,DownloadIcon:g,BrowsersOutlineIcon:e,HammerIcon:c,SendIcon:b}=Y.ionicons5,f=q([{label:U("global.r_preview"),key:"preview",icon:O(e)},{label:U("global.r_copy"),key:"copy",icon:O(m)}]),u=w=>{switch(w){case"preview":k();break;case"copy":x();break}},k=()=>{s("preview",l.cardData)},x=()=>{s("copy",l.cardData)},C=()=>{s("resize",l.cardData)};return(w,P)=>{const S=i("n-image"),d=i("n-text"),v=i("n-badge"),H=i("n-button"),$=i("n-tooltip"),G=i("n-space"),K=i("n-card");return t.cardData?(_(),I("div",pe,[a(K,{hoverable:"",size:"small"},{action:o(()=>[h("div",ve,[a(d,{class:"go-ellipsis-1"},{default:o(()=>[z(E(t.cardData.title||t.cardData.id||"未命名"),1)]),_:1}),h("div",fe,[a(G,null,{default:o(()=>[a(d,null,{default:o(()=>[a(v,{class:"go-animation-twinkle",dot:"",color:t.cardData.release?"#34c749":"#fcbc40"},null,8,["color"]),z(" "+E(t.cardData.release?w.$t("project.release"):w.$t("project.unreleased")),1)]),_:1}),(_(!0),I(B,null,V(f,M=>(_(),D($,{key:M.key,placement:"bottom",trigger:"hover"},{trigger:o(()=>[a(H,{size:"small",onClick:Pe=>u(M.key)},{icon:o(()=>[(_(),D(R(M.icon)))]),_:2},1032,["onClick"])]),default:o(()=>[(_(),D(R(M.label)))]),_:2},1024))),128))]),_:1})])])]),default:o(()=>[h("div",me,[h("div",ge,[a(n(Z),{class:"top-btn",hidden:["remove","close"],onClose:x,onResize:C})]),h("div",{class:"list-content-img",onClick:C},[a(S,{"object-fit":"contain",height:"180","preview-disabled":"",src:`${t.cardData.image}?time=${new Date().getTime()}`,alt:t.cardData.title,"fallback-src":n(X)()},null,8,["src","alt","fallback-src"])])])]),_:1})])):W("",!0)}}});const we=N(he,[["__scopeId","data-v-8f541be3"]]),ye={class:"list-content"},be={class:"list-content-img"},De=["src","alt"],ke=L({__name:"index",props:{modalShow:{required:!0,type:Boolean},cardData:{required:!0,type:Object}},emits:["close","edit"],setup(t,{emit:s}){const l=t,{HammerIcon:p}=Y.ionicons5,m=j(!1);ee(()=>l.modalShow,c=>{m.value=c},{immediate:!0});const y=q([{label:U("global.r_edit"),key:"edit",icon:O(p)}]),r=c=>{switch(c){case"edit":g();break}},g=()=>{s("edit",l.cardData)},e=()=>{s("close")};return(c,b)=>{const f=i("n-text"),u=i("n-space"),k=i("n-time"),x=i("n-badge"),C=i("n-button"),w=i("n-tooltip"),P=i("n-card"),S=i("n-modal");return _(),D(S,{class:"go-modal-box",show:m.value,"onUpdate:show":b[0]||(b[0]=d=>m.value=d),onAfterLeave:e},{default:o(()=>[a(P,{hoverable:"",size:"small"},{action:o(()=>[a(u,{class:"list-footer",justify:"space-between"},{default:o(()=>[a(f,{depth:"3"},{default:o(()=>[z(E(c.$t("project.last_edit"))+": ",1),a(k,{time:new Date,format:"yyyy-MM-dd hh:mm"},null,8,["time"])]),_:1}),a(u,null,{default:o(()=>[a(f,null,{default:o(()=>{var d,v;return[a(x,{class:"go-animation-twinkle",dot:"",color:(d=t.cardData)!=null&&d.release?"#34c749":"#fcbc40"},null,8,["color"]),z(" "+E((v=t.cardData)!=null&&v.release?c.$t("project.release"):c.$t("project.unreleased")),1)]}),_:1}),(_(!0),I(B,null,V(y,d=>(_(),D(w,{key:d.key,placement:"bottom",trigger:"hover"},{trigger:o(()=>[a(C,{size:"small",onClick:v=>r(d.key)},{icon:o(()=>[(_(),D(R(d.icon)))]),_:2},1032,["onClick"])]),default:o(()=>[(_(),D(R(d.label)))]),_:2},1024))),128))]),_:1})]),_:1})]),default:o(()=>{var d,v;return[h("div",ye,[a(u,{class:"list-content-top go-px-0",justify:"center"},{default:o(()=>[a(u,null,{default:o(()=>[a(f,null,{default:o(()=>{var H,$;return[z(E(((H=t.cardData)==null?void 0:H.title)||(($=t.cardData)==null?void 0:$.id)||"未命名"),1)]}),_:1})]),_:1})]),_:1}),a(u,{class:"list-content-top"},{default:o(()=>[a(n(Z),{narrow:!0,hidden:["close"],onRemove:e})]),_:1}),h("div",be,[h("img",{src:(d=t.cardData)==null?void 0:d.image,alt:(v=t.cardData)==null?void 0:v.title},null,8,De)])])]}),_:1})]),_:1},8,["show"])}}});const xe=N(ke,[["__scopeId","data-v-01131fd8"]]),Ce=()=>{const t=j(!1),s=j(null);return{modalData:s,modalShow:t,closeModal:()=>{t.value=!1,s.value=null},resizeHandle:r=>{r&&(t.value=!0,s.value=r)},editHandle:r=>{if(!r)return;const g=te(ae.CHART_HOME_NAME,"href");ne(g,[r.id],void 0,!0)},previewHandle:r=>{oe(se(r.id))}}},He=()=>{const t=j(!0),s=q({page:1,limit:12,count:10}),l=j([]),p=()=>A(void 0,null,function*(){t.value=!0;const e=yield ie({page:s.page,limit:s.limit,random:Math.random()});if(e&&e.data){const{count:c}=e;s.count=c,l.value=e.data.map(b=>{const{id:f,projectName:u,state:k,createTime:x,indexImage:C,createUserId:w}=b;return{id:f,title:u,createId:w,time:x,image:C,release:k!==-1}}),setTimeout(()=>{t.value=!1},500);return}T()}),m=e=>{s.page=e,p()},y=e=>{s.limit=e,p()},r=e=>{_e({type:ue.COPY,promise:!0,onPositiveCallback:()=>new Promise(c=>{c(re({ids:e.id}))}),promiseResCallback:c=>{if(c.code===F.SUCCESS){window.$message.success(window.$t("global.r_copy_success")),ce.push({name:le.BASE_HOME_TEMPLATE_NAME,query:{rand:Math.random()}});return}T()}})},g=(e,c)=>A(void 0,null,function*(){const{id:b,release:f}=e,u=yield de({id:b,state:f?-1:1});if(u&&u.code===F.SUCCESS){if(l.value=[],p(),f){window.$message.success(window.$t("global.r_unpublish_success"));return}window.$message.success(window.$t("global.r_publish_success"));return}T()});return p(),{loading:t,paginat:s,list:l,fetchList:p,releaseHandle:g,changeSize:y,changePage:m,copyHandle:r}},$e={class:"go-items-list"},Ie={class:"list-pagination"},Se=L({__name:"index",setup(t){const{modalData:s,modalShow:l,closeModal:p,previewHandle:m,resizeHandle:y,editHandle:r}=Ce(),{loading:g,paginat:e,list:c,changeSize:b,changePage:f,releaseHandle:u,copyHandle:k}=He();return(x,C)=>{const w=i("go-loading"),P=i("n-grid-item"),S=i("n-grid"),d=i("n-pagination");return _(),I(B,null,[h("div",$e,[J(h("div",null,[a(w)],512),[[Q,n(g)]]),J(h("div",null,[a(S,{"x-gap":20,"y-gap":20,cols:"2 s:2 m:3 l:4 xl:4 xxl:4",responsive:"screen"},{default:o(()=>[(_(!0),I(B,null,V(n(c),(v,H)=>(_(),D(P,{key:v.id},{default:o(()=>[a(n(we),{cardData:v,onPreview:n(m),onResize:n(y),onCopy:$=>n(k)(v),onRelease:$=>n(u)(v,H),onEdit:n(r)},null,8,["cardData","onPreview","onResize","onCopy","onRelease","onEdit"])]),_:2},1024))),128))]),_:1})],512),[[Q,!n(g)]]),h("div",Ie,[a(d,{page:n(e).page,"page-size":n(e).limit,"item-count":n(e).count,"page-sizes":[12,24,36,48],"onUpdate:page":n(f),"onUpdate:pageSize":n(b),"show-size-picker":""},null,8,["page","page-size","item-count","onUpdate:page","onUpdate:pageSize"])])]),n(s)?(_(),D(n(xe),{key:0,modalShow:n(l),cardData:n(s),onClose:n(p),onEdit:n(r)},null,8,["modalShow","cardData","onClose","onEdit"])):W("",!0)],64)}}});const ze=N(Se,[["__scopeId","data-v-616845e5"]]),Ee={class:"go-project-items"},je=L({__name:"index",setup(t){return(s,l)=>(_(),I("div",Ee,[a(n(ze))]))}});const Te=N(je,[["__scopeId","data-v-d854295b"]]);export{Te as default};
