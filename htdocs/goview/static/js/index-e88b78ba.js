var q=(t,n,c)=>new Promise((p,g)=>{var D=i=>{try{v(c.next(i))}catch(e){g(e)}},d=i=>{try{v(c.throw(i))}catch(e){g(e)}},v=i=>i.done?p(i.value):Promise.resolve(i.value).then(D,d);v((c=c.apply(t,n)).next())});import{d as U,l as F,H as C,Z as S,j as P,r as l,o as r,c as E,b as a,w as o,n as b,e as R,t as B,F as A,q as J,D as k,E as L,u as s,a5 as le,a6 as X,h as O,J as ie,M as re,I as de,N as _e,a7 as ue,a8 as pe,a9 as T,R as V,aa as me,P as ge,Q as Y,U as Z}from"./index-3efa3bcd.js";import{i as ee}from"./icon-f6cbc454.js";import{M as te}from"./index-378130bb.js";import{p as ve,d as he,a as be,b as we}from"./project.api-31a95c84.js";import{g as G,D as K}from"./plugin-52ae8d1b.js";const fe={key:0,class:"go-items-list-card"},ye={class:"list-content"},ke={class:"list-content-top"},De={class:"go-flex-items-center list-footer",justify:"space-between"},Ce={class:"go-flex-items-center list-footer-ri"},He=U({__name:"index",props:{cardData:Object},emits:["preview","delete","copy","resize","edit","release"],setup(t,{emit:n}){var y;const c=t,{EllipsisHorizontalCircleSharpIcon:p,CopyIcon:g,TrashIcon:D,PencilIcon:d,DownloadIcon:v,BrowsersOutlineIcon:i,HammerIcon:e,SendIcon:_}=ee.ionicons5,w=F([{label:C("global.r_edit"),key:"edit",icon:S(e)},{lable:C("global.r_more"),key:"select",icon:S(p)}]),m=P([{label:C("global.r_preview"),key:"preview",icon:S(i)},{label:(y=c.cardData)!=null&&y.release?C("global.r_unpublish"):C("global.r_publish"),key:"release",icon:S(_)},{label:C("global.r_copy"),key:"copy",icon:S(g)},{label:C("global.r_delete"),key:"delete",icon:S(D)}]),f=h=>{switch(h){case"preview":H();break;case"delete":x();break;case"copy":I();break;case"release":j();break;case"edit":$();break}},H=()=>{n("preview",c.cardData)},x=()=>{n("delete",c.cardData)},I=()=>{n("copy",c.cardData)},$=()=>{n("edit",c.cardData)},j=()=>{n("release",c.cardData)},u=()=>{n("resize",c.cardData)};return(h,M)=>{const N=l("n-image"),Q=l("n-text"),ae=l("n-badge"),W=l("n-button"),ne=l("n-dropdown"),oe=l("n-tooltip"),se=l("n-space"),ce=l("n-card");return t.cardData?(r(),E("div",fe,[a(ce,{hoverable:"",size:"small"},{action:o(()=>[b("div",De,[a(Q,{class:"go-ellipsis-1"},{default:o(()=>[R(B(t.cardData.title||t.cardData.id||"未命名"),1)]),_:1}),b("div",Ce,[a(se,null,{default:o(()=>[a(Q,null,{default:o(()=>[a(ae,{class:"go-animation-twinkle",dot:"",color:t.cardData.release?"#34c749":"#fcbc40"},null,8,["color"]),R(" "+B(t.cardData.release?h.$t("project.release"):h.$t("project.unreleased")),1)]),_:1}),(r(!0),E(A,null,J(w,z=>(r(),E(A,{key:z.key},[z.key==="select"?(r(),k(ne,{key:0,trigger:"hover",placement:"bottom",options:m.value,"show-arrow":!0,onSelect:f},{default:o(()=>[a(W,{size:"small"},{icon:o(()=>[(r(),k(L(z.icon)))]),_:2},1024)]),_:2},1032,["options"])):(r(),k(oe,{key:1,placement:"bottom",trigger:"hover"},{trigger:o(()=>[a(W,{size:"small",onClick:Te=>f(z.key)},{icon:o(()=>[(r(),k(L(z.icon)))]),_:2},1032,["onClick"])]),default:o(()=>[(r(),k(L(z.label)))]),_:2},1024))],64))),128))]),_:1})])])]),default:o(()=>[b("div",ye,[b("div",ke,[a(s(te),{class:"top-btn",hidden:["remove"],onClose:x,onResize:u})]),b("div",{class:"list-content-img",onClick:u},[a(N,{"object-fit":"contain",height:"180","preview-disabled":"",src:`${t.cardData.image}?time=${new Date().getTime()}`,alt:t.cardData.title,"fallback-src":s(le)()},null,8,["src","alt","fallback-src"])])])]),_:1})])):X("",!0)}}});const xe=O(He,[["__scopeId","data-v-624bd3aa"]]),$e={class:"list-content"},Se={class:"list-content-img"},Ee=["src","alt"],Ie=U({__name:"index",props:{modalShow:{required:!0,type:Boolean},cardData:{required:!0,type:Object}},emits:["close","edit"],setup(t,{emit:n}){const c=t,{HammerIcon:p}=ee.ionicons5,g=P(!1);ie(()=>c.modalShow,e=>{g.value=e},{immediate:!0});const D=F([{label:C("global.r_edit"),key:"edit",icon:S(p)}]),d=e=>{switch(e){case"edit":v();break}},v=()=>{n("edit",c.cardData)},i=()=>{n("close")};return(e,_)=>{const w=l("n-text"),m=l("n-space"),f=l("n-time"),H=l("n-badge"),x=l("n-button"),I=l("n-tooltip"),$=l("n-card"),j=l("n-modal");return r(),k(j,{class:"go-modal-box",show:g.value,"onUpdate:show":_[0]||(_[0]=u=>g.value=u),onAfterLeave:i},{default:o(()=>[a($,{hoverable:"",size:"small"},{action:o(()=>[a(m,{class:"list-footer",justify:"space-between"},{default:o(()=>[a(w,{depth:"3"},{default:o(()=>[R(B(e.$t("project.last_edit"))+": ",1),a(f,{time:new Date,format:"yyyy-MM-dd hh:mm"},null,8,["time"])]),_:1}),a(m,null,{default:o(()=>[a(w,null,{default:o(()=>{var u,y;return[a(H,{class:"go-animation-twinkle",dot:"",color:(u=t.cardData)!=null&&u.release?"#34c749":"#fcbc40"},null,8,["color"]),R(" "+B((y=t.cardData)!=null&&y.release?e.$t("project.release"):e.$t("project.unreleased")),1)]}),_:1}),(r(!0),E(A,null,J(D,u=>(r(),k(I,{key:u.key,placement:"bottom",trigger:"hover"},{trigger:o(()=>[a(x,{size:"small",onClick:y=>d(u.key)},{icon:o(()=>[(r(),k(L(u.icon)))]),_:2},1032,["onClick"])]),default:o(()=>[(r(),k(L(u.label)))]),_:2},1024))),128))]),_:1})]),_:1})]),default:o(()=>{var u,y;return[b("div",$e,[a(m,{class:"list-content-top go-px-0",justify:"center"},{default:o(()=>[a(m,null,{default:o(()=>[a(w,null,{default:o(()=>{var h,M;return[R(B(((h=t.cardData)==null?void 0:h.title)||((M=t.cardData)==null?void 0:M.id)||"未命名"),1)]}),_:1})]),_:1})]),_:1}),a(m,{class:"list-content-top"},{default:o(()=>[a(s(te),{narrow:!0,hidden:["close"],onRemove:i})]),_:1}),b("div",Se,[b("img",{src:(u=t.cardData)==null?void 0:u.image,alt:(y=t.cardData)==null?void 0:y.title},null,8,Ee)])])]}),_:1})]),_:1},8,["show"])}}});const ze=O(Ie,[["__scopeId","data-v-4e20ec8e"]]),Pe=()=>{const t=P(!1),n=P(null);return{modalData:n,modalShow:t,closeModal:()=>{t.value=!1,n.value=null},resizeHandle:d=>{d&&(t.value=!0,n.value=d)},editHandle:d=>{if(!d)return;const v=re(de.CHART_HOME_NAME,"href");_e(v,[d.id],void 0,!0)},previewHandle:d=>{ue(pe(d.id))}}},je=()=>{const t=P(!0),n=F({page:1,limit:12,count:10}),c=P([]),p=()=>q(void 0,null,function*(){t.value=!0;const e=yield ve({page:n.page,limit:n.limit,random:Math.random()});if(e&&e.data){const{count:_}=e;n.count=_,c.value=e.data.map(w=>{const{id:m,projectName:f,state:H,createTime:x,indexImage:I,createUserId:$}=w;return{id:m,title:f,createId:$,time:x,image:I,release:H!==-1}}),setTimeout(()=>{t.value=!1},500);return}T()}),g=e=>{n.page=e,p()},D=e=>{n.limit=e,p()},d=e=>{G({type:K.DELETE,promise:!0,onPositiveCallback:()=>new Promise(_=>{_(he({ids:e.id}))}),promiseResCallback:_=>{if(_.code===V.SUCCESS){window.$message.success(window.$t("global.r_delete_success")),p();return}T()}})},v=e=>{G({type:K.COPY,promise:!0,onPositiveCallback:()=>new Promise(_=>{_(be({ids:e.id}))}),promiseResCallback:_=>{if(_.code===V.SUCCESS){window.$message.success(window.$t("global.r_copy_success")),me.push({name:ge.BASE_HOME_TEMPLATE_NAME,query:{rand:Math.random()}});return}T()}})},i=(e,_)=>q(void 0,null,function*(){const{id:w,release:m}=e,f=yield we({id:w,state:m?-1:1});if(f&&f.code===V.SUCCESS){if(c.value=[],p(),m){window.$message.success(window.$t("global.r_unpublish_success"));return}window.$message.success(window.$t("global.r_publish_success"));return}T()});return p(),{loading:t,paginat:n,list:c,fetchList:p,releaseHandle:i,changeSize:D,changePage:g,deleteHandle:d,copyHandle:v}},Me={class:"go-items-list"},Re={class:"list-pagination"},Be=U({__name:"index",setup(t){const{modalData:n,modalShow:c,closeModal:p,previewHandle:g,resizeHandle:D,editHandle:d}=Pe(),{loading:v,paginat:i,list:e,changeSize:_,changePage:w,releaseHandle:m,deleteHandle:f,copyHandle:H}=je();return(x,I)=>{const $=l("go-loading"),j=l("n-grid-item"),u=l("n-grid"),y=l("n-pagination");return r(),E(A,null,[b("div",Me,[Y(b("div",null,[a($)],512),[[Z,s(v)]]),Y(b("div",null,[a(u,{"x-gap":20,"y-gap":20,cols:"2 s:2 m:3 l:4 xl:4 xxl:4",responsive:"screen"},{default:o(()=>[(r(!0),E(A,null,J(s(e),(h,M)=>(r(),k(j,{key:h.id},{default:o(()=>[a(s(xe),{cardData:h,onPreview:s(g),onResize:s(D),onDelete:N=>s(f)(h),onCopy:N=>s(H)(h),onRelease:N=>s(m)(h,M),onEdit:s(d)},null,8,["cardData","onPreview","onResize","onDelete","onCopy","onRelease","onEdit"])]),_:2},1024))),128))]),_:1})],512),[[Z,!s(v)]]),b("div",Re,[a(y,{page:s(i).page,"page-size":s(i).limit,"item-count":s(i).count,"page-sizes":[12,24,36,48],"onUpdate:page":s(w),"onUpdate:pageSize":s(_),"show-size-picker":""},null,8,["page","page-size","item-count","onUpdate:page","onUpdate:pageSize"])])]),s(n)?(r(),k(s(ze),{key:0,modalShow:s(c),cardData:s(n),onClose:s(p),onEdit:s(d)},null,8,["modalShow","cardData","onClose","onEdit"])):X("",!0)],64)}}});const Le=O(Be,[["__scopeId","data-v-d7304eca"]]),Ae={class:"go-project-items"},Ne=U({__name:"index",setup(t){return(n,c)=>(r(),E("div",Ae,[a(s(Le))]))}});const Qe=O(Ne,[["__scopeId","data-v-3dabb86e"]]);export{Qe as default};
